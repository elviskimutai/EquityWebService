@echo off
set curdir=%cd%

SET PROG=%curdir%
SET SERVICE_EXE=%"%\EFTConnectSvc.exe%"%
SET FIRSTPART=%WINDIR%"\Microsoft.NET\Framework\v"
SET SECONDPART="\InstallUtil.exe"
SET SERVICENAME=%"%EFTConnectSvc%"%
SET DELETEBATCH="\*.bat"

SET DOTNETVER=4.0.30319
IF EXIST %FIRSTPART%%DOTNETVER%%SECONDPART% GOTO install
SET DOTNETVER=3.5
IF EXIST %FIRSTPART%%DOTNETVER%%SECONDPART% GOTO install
SET DOTNETVER=3.0
IF EXIST %FIRSTPART%%DOTNETVER%%SECONDPART% GOTO install
SET DOTNETVER=2.0.50727
IF EXIST %FIRSTPART%%DOTNETVER%%SECONDPART% GOTO install
SET DOTNETVER=1.1.4322
IF EXIST %FIRSTPART%%DOTNETVER%%SECONDPART% GOTO install
SET DOTNETVER=1.0.3705
IF EXIST %FIRSTPART%%DOTNETVER%%SECONDPART% GOTO install
GOTO fail
:install
ECHO Found .NET Framework version %DOTNETVER%
ECHO Installing Windows Service
%FIRSTPART%%DOTNETVER%%SECONDPART% /u /name=%SERVICENAME% "%PROG%%SERVICE_EXE%" 
rem %FIRSTPART%%DOTNETVER%%SECONDPART% delete /name=%SERVICENAME% "%PROG%%SERVICE_EXE%" 
rem RD "%PROG%" /s 
GOTO end
:fail
echo FAILURE -- Could not find .NET Framework install
:end
ECHO DONE!!!
Pause